{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\src\\\\components\\\\login.component.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport axios from 'axios';\nimport CryptoJS from \"react-native-crypto-js\";\nimport { codes } from \"../secrets/secrets.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport { authService } from \"./modules/authService\";\nimport decode from \"jwt-decode\";\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props)); //redirects to home if already logged in\n\n    _this.handleUsername = function (event) {\n      _this.setState({\n        email: event.target.value\n      });\n    };\n\n    _this.handlePassword = function (event) {\n      _this.setState({\n        psw: event.target.value\n      });\n    };\n\n    _this.onSubmit = function (event) {\n      event.preventDefault();\n      CryptoJS.pad.NoPadding = {\n        pad: function pad() {},\n        unpad: function unpad() {}\n      };\n      var encrypted = CryptoJS.AES.encrypt(_this.state.email, codes.staff, {\n        iv: codes.iv\n      });\n      var pass = CryptoJS.AES.encrypt(_this.state.psw, codes.staffPass);\n      var user = {\n        username: encrypted.toString(),\n        password: pass.toString(),\n        token: ''\n      };\n      var token = {\n        token: ''\n      };\n      var currentUser = authService.currentUserValue;\n      axios.post('http://' + process.env.REACT_APP_AWS_IP + ':4000/auth/login', user).then(function (res) {\n        if (res.status === 200) {\n          if (typeof res.data.user.role === \"undefined\") {\n            document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/trainee-details/' + res.data.user._id;\n            token.token = decode(res.data.token);\n            localStorage.setItem('currentUser', JSON.stringify(token));\n          } else if (res.data.user.role === \"admin\") {\n            document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/admin';\n            token.token = decode(res.data.token);\n            localStorage.setItem('currentUser', JSON.stringify(token));\n          } else {\n            document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/'; //Get user token and decode user token here\n\n            token.token = decode(res.data.token);\n            localStorage.setItem('currentUser', JSON.stringify(token));\n          }\n        } else if (res.status === 204) {\n          console.log('email and password do not match');\n          alert('Username or Password does not match');\n        } else {\n          console.log('Account does not exist');\n          alert(\"Email does not exist\");\n        }\n      }).catch(function (error) {\n        alert(\"Invalid Email/Password\");\n        console.log(error.response);\n      });\n    };\n\n    if (authService.currentUserValue) {\n      _this.props.history.push('/');\n    }\n\n    _this.state = {\n      uname: '',\n      psw: ''\n    };\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"forgotPassword\",\n    value: function forgotPassword() {\n      document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/forgotPassword';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"Login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        className: \"form\",\n        onSubmit: this.onSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"uname\",\n        bsSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, \"Email\")), React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter Email\",\n        name: \"email\",\n        onChange: this.handleUsername,\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"psw\",\n        bsSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, \"Password\")), React.createElement(\"input\", {\n        type: \"password\",\n        placeholder: \"Enter Password\",\n        name: \"psw\",\n        onChange: this.handlePassword,\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"btn\",\n        value: \"Login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"forgotBtn\",\n        onClick: this.forgotPassword,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, \"FORGOT PASSWORD?\")));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport { Login as default };","map":{"version":3,"sources":["C:\\Users\\Chi Zhang\\Desktop\\QA Bursary project\\AWS-Bursary-Project-V1\\React\\src\\components\\login.component.js"],"names":["React","Component","Redirect","axios","CryptoJS","codes","BehaviorSubject","authService","decode","Login","props","handleUsername","event","setState","email","target","value","handlePassword","psw","onSubmit","preventDefault","pad","NoPadding","unpad","encrypted","AES","encrypt","state","staff","iv","pass","staffPass","user","username","toString","password","token","currentUser","currentUserValue","post","process","env","REACT_APP_AWS_IP","then","res","status","data","role","document","location","href","_id","localStorage","setItem","JSON","stringify","console","log","alert","catch","error","response","history","push","uname","forgotPassword"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom'\r\nimport axios from 'axios';\r\nimport CryptoJS from \"react-native-crypto-js\";\r\nimport { codes } from \"../secrets/secrets.js\";\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { authService } from \"./modules/authService\";\r\nimport decode from \"jwt-decode\";\r\n\r\nexport default class Login extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        //redirects to home if already logged in\r\n        if (authService.currentUserValue) {\r\n            this.props.history.push('/');\r\n        }\r\n        this.state = {\r\n            uname: '',\r\n            psw: '',\r\n        };\r\n    }\r\n\r\n    handleUsername = event => {\r\n        this.setState({\r\n            email: event.target.value\r\n        });\r\n    }\r\n\r\n    handlePassword = event => {\r\n        this.setState({\r\n            psw: event.target.value\r\n        })\r\n    }\r\n\t\r\n\tforgotPassword (){\r\n\t\tdocument.location.href = 'http://'+process.env.REACT_APP_AWS_IP+':3000/forgotPassword';\r\n\t}\r\n\r\n    onSubmit = event => {\r\n        event.preventDefault();\r\n        CryptoJS.pad.NoPadding = { pad: function () { }, unpad: function () { } };\r\n\r\n        var encrypted = CryptoJS.AES.encrypt(this.state.email, codes.staff, { iv: codes.iv });\r\n        var pass = CryptoJS.AES.encrypt(this.state.psw, codes.staffPass);\r\n        const user = {\r\n            username: encrypted.toString(),\r\n            password: pass.toString(),\r\n            token: ''\r\n        };\r\n\r\n        const token = {\r\n            token: ''\r\n        };\r\n        const currentUser = authService.currentUserValue;\r\n\r\n        axios.post('http://'+process.env.REACT_APP_AWS_IP+':4000/auth/login', user)\r\n            .then(function (res) {\r\n                if (res.status === 200) {\r\n                    if (typeof res.data.user.role === \"undefined\") {\r\n                        document.location.href = 'http://'+process.env.REACT_APP_AWS_IP+':3000/trainee-details/' + res.data.user._id\r\n                        token.token = decode(res.data.token);\r\n                        localStorage.setItem('currentUser', JSON.stringify(token));\r\n                    }\r\n                    else if (res.data.user.role === \"admin\") {\r\n                        document.location.href = 'http://'+process.env.REACT_APP_AWS_IP+':3000/admin';\r\n                        token.token = decode(res.data.token);\r\n                        localStorage.setItem('currentUser', JSON.stringify(token));\r\n                    } else {\r\n                        document.location.href = 'http://'+process.env.REACT_APP_AWS_IP+':3000/';\r\n                        //Get user token and decode user token here\r\n                        token.token = decode(res.data.token);\r\n                        localStorage.setItem('currentUser', JSON.stringify(token));\r\n                    }\r\n                }\r\n                else if (res.status === 204) {\r\n                    console.log('email and password do not match');\r\n                    alert('Username or Password does not match')\r\n                } else {\r\n                    console.log('Account does not exist');\r\n                    alert(\"Email does not exist\");\r\n                }\r\n            })\r\n            .catch(error => {\r\n                alert(\"Invalid Email/Password\");\r\n                console.log(error.response)\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"Login\">\r\n                <form className=\"form\" onSubmit={this.onSubmit}>\r\n                    {/* <p className=\"h5 text-center mb-4\" >Sign in</p> */}\r\n                    <label className=\"uname\" bsSize=\"large\"><b>Email</b></label>\r\n                    <input type=\"text\" placeholder=\"Enter Email\" name=\"email\" onChange={this.handleUsername} required />\r\n                    <br/>\r\n                    <label className=\"psw\" bsSize=\"large\"><b>Password</b></label>\r\n                    <input type=\"password\" placeholder=\"Enter Password\" name=\"psw\" onChange={this.handlePassword} required />\r\n                    <br />\r\n                    <br/>\r\n                    <input type=\"submit\" className=\"btn\" value=\"Login\"/>\r\n\t\t\t\t\t<button className=\"forgotBtn\" onClick={this.forgotPassword}>FORGOT PASSWORD?</button> \r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}