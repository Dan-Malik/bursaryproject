{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\src\\\\components\\\\myTrainees.component.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport CryptoJS from \"react-native-crypto-js\";\nimport { codes } from \"../secrets/secrets.js\";\nimport AccessDenied from './modules/AccessDenied';\nimport { authService } from './modules/authService';\nimport '../css/list-trainee-recruiter.css';\n\nvar ListTrainee =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ListTrainee, _Component);\n\n  function ListTrainee(props) {\n    var _this;\n\n    _classCallCheck(this, ListTrainee);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ListTrainee).call(this, props));\n    _this.state = {\n      trainees: [],\n      searchString: \"\",\n      currentUser: authService.currentUserValue,\n      recruiterEmail: \"\"\n    }; //Added onChangeSearch - Ernie\n\n    _this.onChangeSearch = _this.onChangeSearch.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ListTrainee, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/trainee/').then(function (response) {\n        var encrypted = response.data;\n        encrypted.map(function (currentTrainee, i) {\n          var bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_email, codes.staff, {\n            iv: codes.iv\n          });\n          currentTrainee.trainee_email = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_fname, codes.trainee);\n          currentTrainee.trainee_fname = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_lname, codes.trainee);\n          currentTrainee.trainee_lname = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.status, codes.trainee);\n          currentTrainee.status = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.added_By, codes.trainee);\n          currentTrainee.added_By = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.bursary, codes.trainee);\n          currentTrainee.bursary = bytes.toString(CryptoJS.enc.Utf8);\n        });\n\n        _this2.setState({\n          trainees: encrypted\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n      axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/admin/staff/' + this.state.currentUser.token._id).then(function (response) {\n        if (response.data == null) {\n          authService.logout();\n\n          if (!authService.currentUserValue) {\n            document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/login';\n          }\n        } else {\n          var email = CryptoJS.AES.decrypt(response.data.email, codes.staff, {\n            iv: codes.iv\n          }).toString(CryptoJS.enc.Utf8);\n\n          _this2.setState({\n            recruiterEmail: email\n          });\n        }\n      });\n    } // Added onChangeSearch(e) function. Needed for the search filter\n\n  }, {\n    key: \"onChangeSearch\",\n    value: function onChangeSearch(e) {\n      this.setState({\n        searchString: e.target.value\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      //Declared variables in order to read input from search function\n      var trainees = this.state.trainees;\n      var search = this.state.searchString.trim().toLowerCase().replace(/\\s+/g, '');\n\n      if (search.length > 0) {\n        trainees = trainees.filter(function (i) {\n          if (i.trainee_fname.toLowerCase().match(search) || i.status.toLowerCase().match(search) || i.added_By.toLowerCase().match(search) || i.bursary.toLowerCase().match(search) || i.trainee_lname.toLowerCase().match(search) || i.trainee_email.toLowerCase().match(search) || (i.trainee_fname.toLowerCase() + i.trainee_lname.toLowerCase() + i.trainee_email.toLowerCase()).match(search)) {\n            return i;\n          }\n        });\n      }\n\n      if (this.state.currentUser.token.role === undefined) {\n        return React.createElement(AccessDenied, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        });\n      } else if (this.state.currentUser.token.role === 'recruiter') {\n        return React.createElement(\"div\", {\n          className: \"QAtable\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"QASearchBar\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"text\",\n          value: this.state.searchString,\n          onChange: this.onChangeSearch,\n          placeholder: \"Find trainee...\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"addUser\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"qabtn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, React.createElement(Link, {\n          className: \"link\",\n          to: \"/create\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, \"Add Trainee\")))), React.createElement(\"table\", {\n          className: \"table table-striped\",\n          style: {\n            marginTop: 20\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, \"First Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, \"Last Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, \"Email\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, \"Status\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, \"Recruited By\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, \"Bursary\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, \"Action\"))), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, trainees.map(function (t) {\n          if (t.added_By === _this3.state.recruiterEmail) {\n            return React.createElement(\"tr\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 128\n              },\n              __self: this\n            }, React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 129\n              },\n              __self: this\n            }, \" \", t.trainee_fname), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 130\n              },\n              __self: this\n            }, \" \", t.trainee_lname), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 131\n              },\n              __self: this\n            }, \" \", t.trainee_email), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 132\n              },\n              __self: this\n            }, \" \", t.status), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 133\n              },\n              __self: this\n            }, \" \", t.added_By), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 134\n              },\n              __self: this\n            }, \" \", t.bursary), React.createElement(\"td\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 135\n              },\n              __self: this\n            }, \" \", React.createElement(\"button\", {\n              onClick: function onClick() {\n                return window.location.href = \"/editDates/\" + t._id;\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 135\n              },\n              __self: this\n            }, \" Edit \"), React.createElement(\"button\", {\n              onClick: function onClick() {\n                return axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/trainee/delete/' + t._id).then(function (response) {\n                  return window.location.reload();\n                });\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 136\n              },\n              __self: this\n            }, \"Delete\")));\n          }\n        }))));\n      } else {\n        return React.createElement(AccessDenied, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        });\n      }\n    }\n  }]);\n\n  return ListTrainee;\n}(Component);\n\nexport { ListTrainee as default };","map":{"version":3,"sources":["C:\\Users\\Chi Zhang\\Desktop\\QA Bursary project\\AWS-Bursary-Project-V1\\React\\src\\components\\myTrainees.component.js"],"names":["React","Component","Link","axios","CryptoJS","codes","AccessDenied","authService","ListTrainee","props","state","trainees","searchString","currentUser","currentUserValue","recruiterEmail","onChangeSearch","bind","get","process","env","REACT_APP_AWS_IP","then","response","encrypted","data","map","currentTrainee","i","bytes","AES","decrypt","trainee_email","staff","iv","toString","enc","Utf8","trainee_fname","trainee","trainee_lname","status","added_By","bursary","setState","catch","error","console","log","token","_id","logout","document","location","href","email","e","target","value","search","trim","toLowerCase","replace","length","filter","match","role","undefined","marginTop","t","window","reload"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport CryptoJS from \"react-native-crypto-js\";\r\nimport { codes } from \"../secrets/secrets.js\";\r\nimport AccessDenied from './modules/AccessDenied';\r\nimport { authService } from './modules/authService';\r\nimport '../css/list-trainee-recruiter.css';\r\n\r\nexport default class ListTrainee extends Component {\r\n    \r\n    constructor(props) {\r\n        super(props);\r\n\t\t\t\r\n        this.state = {\r\n\t\t\ttrainees: [], \r\n\t\t\tsearchString: \"\",\r\n            currentUser: authService.currentUserValue,\r\n            recruiterEmail: \"\"\r\n\t\t\t};\r\n        \r\n       //Added onChangeSearch - Ernie\r\n        this.onChangeSearch = this.onChangeSearch.bind(this);\r\n    }\r\n    \r\n    componentDidMount() {\r\n        axios.get('http://'+process.env.REACT_APP_AWS_IP+':4000/trainee/')\r\n            .then(response => {\r\n                var encrypted = response.data;\r\n                encrypted.map(function(currentTrainee, i){\r\n                    var bytes  = CryptoJS.AES.decrypt(currentTrainee.trainee_email, codes.staff, {iv: codes.iv});\r\n                    currentTrainee.trainee_email = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_fname, codes.trainee);\r\n                    currentTrainee.trainee_fname = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_lname, codes.trainee);\r\n                    currentTrainee.trainee_lname = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.status, codes.trainee);\r\n                    currentTrainee.status = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.added_By, codes.trainee);\r\n                    currentTrainee.added_By = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.bursary, codes.trainee);\r\n                    currentTrainee.bursary = bytes.toString(CryptoJS.enc.Utf8);\r\n                });\r\n                this.setState({trainees: encrypted});\r\n            })\r\n            .catch(function (error){\r\n                console.log(error);\r\n            });\r\n            axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/admin/staff/' + this.state.currentUser.token._id)\r\n            .then(response => {\r\n              if(response.data == null){\r\n                authService.logout();\r\n                if (!authService.currentUserValue) {\r\n                  document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/login';\r\n                }\r\n              }\r\n              else{\r\n                var email = CryptoJS.AES.decrypt(response.data.email, codes.staff, { iv: codes.iv }).toString(CryptoJS.enc.Utf8);\r\n    \r\n                this.setState({\r\n                  recruiterEmail: email\r\n                })\r\n              }\r\n            });\r\n    }\r\n\r\n    // Added onChangeSearch(e) function. Needed for the search filter\r\n    onChangeSearch(e) {\r\n        this.setState({\r\n            searchString: e.target.value\r\n        });\r\n    }\r\n\t\r\n    render() {\r\n        //Declared variables in order to read input from search function\r\n        let trainees = this.state.trainees;\r\n        let search = this.state.searchString.trim().toLowerCase().replace(/\\s+/g, '');\r\n        \r\n        if(search.length > 0){\r\n            trainees = trainees.filter(function(i){\r\n                if(i.trainee_fname.toLowerCase().match(search) ||\r\n                   i.status.toLowerCase().match(search)        ||\r\n                   i.added_By.toLowerCase().match(search)      ||\r\n                   i.bursary.toLowerCase().match(search)       ||\r\n                   i.trainee_lname.toLowerCase().match(search) ||\r\n                   i.trainee_email.toLowerCase().match(search) ||\r\n                   (i.trainee_fname.toLowerCase() + i.trainee_lname.toLowerCase() + i.trainee_email.toLowerCase()).match(search)){\r\n                    return i;\r\n                }\r\n            })\r\n        }\r\n\t\tif (this.state.currentUser.token.role === undefined){\r\n\t\t\treturn (\r\n\t\t\t<AccessDenied/>\r\n\t\t\t)\r\n\t\t}\r\n\t\telse if(this.state.currentUser.token.role === 'recruiter'){\r\n\t\t\treturn (\r\n            <div className=\"QAtable\">\r\n                <div className=\"QASearchBar\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={this.state.searchString}\r\n                        onChange={this.onChangeSearch}\r\n                        placeholder=\"Find trainee...\"\r\n                    />\r\n                    <div id=\"addUser\">\r\n                        <button className=\"qabtn\"><Link className=\"link\" to={\"/create\"}>Add Trainee</Link></button>\r\n                    </div>\r\n                </div>\r\n\r\n                <table className=\"table table-striped\" style={{ marginTop: 20 }} >\r\n                    <thead>\r\n                        <tr>\r\n                            <th>First Name</th>\r\n                            <th>Last Name</th>\r\n                            <th>Email</th>\r\n                            <th>Status</th>\r\n                            <th>Recruited By</th>\r\n                            <th>Bursary</th>\r\n                            <th>Action</th>\r\n                        </tr>\r\n                    </thead>               \r\n                    <tbody>\r\n                        {trainees.map(t => {\r\n                            if(t.added_By === this.state.recruiterEmail){\r\n                                return (\r\n                                <tr>\r\n                                    <td> {t.trainee_fname}</td>\r\n                                    <td> {t.trainee_lname}</td>\r\n                                    <td> {t.trainee_email}</td>\r\n                                    <td> {t.status}</td>\r\n                                    <td> {t.added_By}</td>\r\n                                    <td> {t.bursary}</td>\r\n                                    <td> <button onClick={() => window.location.href=\"/editDates/\"+t._id}> Edit </button> \r\n                                    <button onClick={()=>axios.get('http://'+process.env.REACT_APP_AWS_IP+':4000/trainee/delete/'+t._id).then((response) => window.location.reload())}>Delete</button>\r\n                                    </td>\r\n                                </tr>\r\n                            );\r\n                            }\r\n                        })}\r\n                    </tbody>\r\n\r\n                </table>\r\n            </div>\r\n        );\r\n\t\t\t\r\n\t\t}else{\r\n        return (\r\n            <AccessDenied/>\r\n        );\r\n\t\t}\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}