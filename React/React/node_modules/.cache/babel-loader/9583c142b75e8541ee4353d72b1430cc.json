{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\src\\\\components\\\\list-user.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport CryptoJS from \"react-native-crypto-js\";\nimport { codes } from \"../secrets/secrets.js\";\nimport { authService } from './modules/authService';\nimport { BrowserRouter, Link } from 'react-router-dom';\nimport AccessDenied from './modules/AccessDenied';\nimport '../css/list-trainee.css';\n\nvar ListUser =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ListUser, _Component);\n\n  function ListUser(props) {\n    var _this;\n\n    _classCallCheck(this, ListUser);\n\n    //redirects to login if not logged in\n    if (!authService.currentUserValue) {\n      document.location.href = 'http://' + process.env.REACT_APP_AWS_IP + ':3000/login'; //this.context.history.push('/login');\n    }\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ListUser).call(this, props));\n    _this.state = {\n      users: [],\n      searchString: \"\",\n      currentUser: authService.currentUserValue\n    };\n    _this.onChangeSearch = _this.onChangeSearch.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ListUser, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/admin/').then(function (response) {\n        if (_this2.state.currentUser.token.role === 'admin') {\n          var encrypted = response.data;\n          encrypted.map(function (currentUser, i) {\n            var bytes = CryptoJS.AES.decrypt(currentUser.email, codes.staff, {\n              iv: codes.iv\n            });\n            currentUser.email = bytes.toString(CryptoJS.enc.Utf8);\n          });\n\n          _this2.setState({\n            users: encrypted\n          });\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"onChangeSearch\",\n    value: function onChangeSearch(e) {\n      this.setState({\n        searchString: e.target.value\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var users = this.state.users;\n      var search = this.state.searchString.trim().toLowerCase();\n\n      if (search.length > 0) {\n        users = users.filter(function (i) {\n          if (i.email.toLowerCase().match(search) || i.role.toLowerCase().match(search)) {\n            return i;\n          }\n        });\n      }\n\n      if (this.state.currentUser.token.role !== 'admin') {\n        return React.createElement(AccessDenied, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        });\n      } else {\n        return React.createElement(\"div\", {\n          className: \"QAtable\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"QASearchBar\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"text\",\n          value: this.state.searchString,\n          onChange: this.onChangeSearch,\n          placeholder: \"Find User..\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"addUser\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"qabtn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        }, React.createElement(Link, {\n          className: \"link\",\n          to: \"/addUser\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        }, \"Add User\")))), React.createElement(\"table\", {\n          className: \"table table-striped\",\n          style: {\n            marginTop: 20\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82\n          },\n          __self: this\n        }, React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, \"Email\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, \"Role\"), React.createElement(\"th\", {\n          className: \"action\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, \"Action\"))), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, users.map(function (user) {\n          return React.createElement(\"tr\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 94\n            },\n            __self: this\n          }, user.email), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 95\n            },\n            __self: this\n          }, user.role), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            onClick: function onClick() {\n              return axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/admin/delete/' + user._id).then(function (response) {\n                return window.location.reload();\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97\n            },\n            __self: this\n          }, \"Delete\")));\n        }))));\n      }\n    }\n  }]);\n\n  return ListUser;\n}(Component);\n\nexport { ListUser as default };","map":{"version":3,"sources":["C:\\Users\\Chi Zhang\\Desktop\\QA Bursary project\\AWS-Bursary-Project-V1\\React\\src\\components\\list-user.component.js"],"names":["React","Component","axios","CryptoJS","codes","authService","BrowserRouter","Link","AccessDenied","ListUser","props","currentUserValue","document","location","href","process","env","REACT_APP_AWS_IP","state","users","searchString","currentUser","onChangeSearch","bind","get","then","response","token","role","encrypted","data","map","i","bytes","AES","decrypt","email","staff","iv","toString","enc","Utf8","setState","catch","error","console","log","e","target","value","search","trim","toLowerCase","length","filter","match","marginTop","user","_id","window","reload"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport CryptoJS from \"react-native-crypto-js\";\r\nimport { codes } from \"../secrets/secrets.js\";\r\nimport { authService } from './modules/authService';\r\nimport { BrowserRouter, Link } from 'react-router-dom'\r\nimport AccessDenied from './modules/AccessDenied';\r\nimport '../css/list-trainee.css';\r\n\r\n\r\nexport default class ListUser extends Component {\r\n    \r\n    constructor(props) {\r\n\t\t\t//redirects to login if not logged in\r\n\tif (!authService.currentUserValue){\r\n\t\t\tdocument.location.href = 'http://'+process.env.REACT_APP_AWS_IP+':3000/login';\r\n\t\t\t//this.context.history.push('/login');\r\n\t\t}\r\n        super(props);\r\n\t\t\r\n        this.state = {\r\n\t\t\tusers: [], \r\n\t\t\tsearchString:\"\",\r\n\t\t\tcurrentUser: authService.currentUserValue\r\n\t\t\t};\r\n        this.onChangeSearch = this.onChangeSearch.bind(this);\r\n    }\r\n\t\r\n    \r\n    componentDidMount() {\r\n        axios.get('http://'+process.env.REACT_APP_AWS_IP+':4000/admin/')\r\n            .then(response => {\r\n\t\t\tif(this.state.currentUser.token.role === 'admin'){\r\n                var encrypted = response.data;\r\n                encrypted.map(function(currentUser, i){\r\n                    var bytes = CryptoJS.AES.decrypt(currentUser.email, codes.staff ,{iv: codes.iv});\r\n                    currentUser.email = bytes.toString(CryptoJS.enc.Utf8);\r\n                });\r\n                this.setState({users: encrypted});\r\n            }\r\n\t\t\t})\r\n            .catch(function (error){\r\n                console.log(error);\r\n            })\r\n\t\t}\r\n\r\n    onChangeSearch(e) {\r\n        this.setState({\r\n            searchString: e.target.value\r\n        })\r\n    }\r\n\r\n    \r\n    render() {\r\n        let users = this.state.users;\r\n        let search = this.state.searchString.trim().toLowerCase();\r\n\r\n        if(search.length > 0){\r\n            users = users.filter(function(i){\r\n                if(i.email.toLowerCase().match(search) || i.role.toLowerCase().match(search)){\r\n                    return i;\r\n                }\r\n            })\r\n        }\r\n\t   if(this.state.currentUser.token.role !== 'admin'){\r\n\t\t   return (\r\n\t\t   < AccessDenied />\r\n\t   );} else{\r\n        return (\r\n            <div className=\"QAtable\">\r\n                <div className=\"QASearchBar\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={this.state.searchString}\r\n                        onChange={this.onChangeSearch}\r\n                        placeholder=\"Find User..\" \r\n                    />\r\n                    <div id=\"addUser\">\r\n                        <button className=\"qabtn\"><Link className=\"link\" to ={\"/addUser\"}>Add User</Link></button>\r\n                    </div>\r\n                </div>\r\n                <table className=\"table table-striped\" style={{ marginTop: 20 }} >\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Email</th>\r\n                            <th>Role</th>\r\n                            <th className=\"action\">Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {users.map(user => {\r\n                            return (\r\n                                <tr>\r\n                                <td>{user.email}</td>\r\n                                <td>{user.role}</td>\r\n                                <td>\r\n                                    <button onClick={()=>axios.get('http://'+process.env.REACT_APP_AWS_IP+':4000/admin/delete/'+user._id).then((response) => window.location.reload())}>Delete</button>\r\n                                </td>\r\n                            </tr>\r\n                            )\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        )\r\n\t   }\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}