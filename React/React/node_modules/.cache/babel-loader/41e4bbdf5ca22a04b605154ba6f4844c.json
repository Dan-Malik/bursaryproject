{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Chi Zhang\\\\Desktop\\\\QA Bursary project\\\\AWS-Bursary-Project-V1\\\\React\\\\src\\\\components\\\\exportDates..component.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport CryptoJS from \"react-native-crypto-js\";\nimport { codes } from \"../secrets/secrets.js\";\nimport AccessDenied from './modules/AccessDenied';\nimport { authService } from './modules/authService';\nimport '../css/list-trainee-recruiter.css';\nimport DatePicker from 'react-datepicker';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { CSVLink } from \"react-csv\";\nimport moment from 'moment';\n\nvar ListTrainee =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ListTrainee, _Component);\n\n  function ListTrainee(props) {\n    var _this;\n\n    _classCallCheck(this, ListTrainee);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ListTrainee).call(this, props));\n\n    _this.onChangeSearch = function (e) {\n      _this.setState({\n        searchString: e,\n        selectedDate: e\n      });\n    };\n\n    _this.state = {\n      trainees: [],\n      searchString: '',\n      currentUser: authService.currentUserValue,\n      selectedDate: '',\n      csv: ''\n    }; //Added onChangeSearch - Ernie\n\n    _this.onChangeSearch = _this.onChangeSearch.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ListTrainee, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      axios.get('http://' + process.env.REACT_APP_AWS_IP + ':4000/trainee/').then(function (response) {\n        var encrypted = response.data;\n        encrypted.map(function (currentTrainee, i) {\n          var bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_email, codes.staff, {\n            iv: codes.iv\n          });\n          currentTrainee.trainee_email = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_fname, codes.trainee);\n          currentTrainee.trainee_fname = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_lname, codes.trainee);\n          currentTrainee.trainee_lname = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_start_date, codes.trainee);\n          currentTrainee.trainee_start_date = bytes.toString(CryptoJS.enc.Utf8);\n          bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_end_date, codes.trainee);\n          currentTrainee.trainee_end_date = bytes.toString(CryptoJS.enc.Utf8);\n\n          if (currentTrainee.trainee_bank_name != undefined && currentTrainee.trainee_account_no != undefined && currentTrainee.trainee_sort_code != undefined) {\n            console.log(currentTrainee.trainee_fname);\n            bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_bank_name, codes.trainee);\n            currentTrainee.trainee_bank_name = bytes.toString(CryptoJS.enc.Utf8);\n            bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_account_no, codes.trainee);\n            currentTrainee.trainee_account_no = bytes.toString(CryptoJS.enc.Utf8);\n            bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_sort_code, codes.trainee);\n            currentTrainee.trainee_sort_code = bytes.toString(CryptoJS.enc.Utf8);\n          }\n        });\n\n        _this2.setState({\n          trainees: encrypted\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } // Added onChangeSearch(e) function. Needed for the search filter\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      //Declared variables in order to read input from search function\n      var trainees = this.state.trainees;\n      var search = this.state.searchString;\n      var output = this.state.csv;\n      var role = this.state.currentUser.token.role;\n\n      if (role === 'finance') {\n        output = [[\"First Name\", \"Last Name\", \"Email\", \"Bank Name\", \"Account Number\", \"Sort Number\", \"Start-Date\", \"End-Date\"]];\n      } else {\n        output = [[\"First Name\", \"Last Name\", \"Email\", \"Start-Date\", \"End-Date\"]];\n      }\n\n      console.log(search.toString().split(\" \", 4).toString());\n\n      if (search.length > 0) {\n        trainees = trainees.filter(function (i) {\n          if (search == null) {\n            return i;\n          } else if (i.trainee_start_date.split(\" \", 4).toString() === search.toString().split(\" \", 4).toString()) {\n            if (role === 'finance') {\n              var obj = [i.trainee_fname, i.trainee_lname, i.trainee_email, i.trainee_bank_name, i.trainee_account_no, i.trainee_sort_code, moment(i.trainee_start_date).format('MMMM Do YYYY'), moment(i.trainee_end_date).format('MMMM Do YYYY')];\n              output.push(obj);\n              console.log(output);\n              return i;\n            } else if (role === 'admin') {\n              var obj = [i.trainee_fname, i.trainee_lname, i.trainee_email, moment(i.trainee_start_date).format('MMMM Do YYYY'), moment(i.trainee_end_date).format('MMMM Do YYYY')];\n              output.push(obj);\n              console.log(output);\n              return i;\n            }\n          }\n        });\n      }\n\n      if (this.state.currentUser.token.role === 'finance' || this.state.currentUser.token.role === 'admin') {\n        return React.createElement(\"div\", {\n          className: \"QAtable\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"QASearchBar\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, React.createElement(DatePicker, {\n          selected: this.state.selectedDate,\n          onChange: this.onChangeSearch,\n          dateFormat: \"dd/MM/yyyy\",\n          placeholderText: \"Specify Start Date to filter\",\n          strictParsing: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"addUser\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"qabtn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(CSVLink, {\n          className: \"link\",\n          data: output,\n          filename: \"monthly-intake.csv\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, \"Download CSV \")))), React.createElement(\"table\", {\n          className: \"table table-striped\",\n          style: {\n            marginTop: 20\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"First Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, \"Last Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \"Email\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, \"Start Date\"))), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }, trainees.map(function (t) {\n          return React.createElement(\"tr\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 135\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          }, \" \", t.trainee_fname), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 137\n            },\n            __self: this\n          }, \" \", t.trainee_lname), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 138\n            },\n            __self: this\n          }, \" \", t.trainee_email), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 139\n            },\n            __self: this\n          }, \" \", moment(t.trainee_start_date).format('MMMM Do YYYY')));\n        }))));\n      } else {\n        return React.createElement(AccessDenied, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        });\n      }\n    }\n  }]);\n\n  return ListTrainee;\n}(Component);\n\nexport { ListTrainee as default };","map":{"version":3,"sources":["C:\\Users\\Chi Zhang\\Desktop\\QA Bursary project\\AWS-Bursary-Project-V1\\React\\src\\components\\exportDates..component.js"],"names":["React","Component","Link","axios","CryptoJS","codes","AccessDenied","authService","DatePicker","CSVLink","moment","ListTrainee","props","onChangeSearch","e","setState","searchString","selectedDate","state","trainees","currentUser","currentUserValue","csv","bind","get","process","env","REACT_APP_AWS_IP","then","response","encrypted","data","map","currentTrainee","i","bytes","AES","decrypt","trainee_email","staff","iv","toString","enc","Utf8","trainee_fname","trainee","trainee_lname","trainee_start_date","trainee_end_date","trainee_bank_name","undefined","trainee_account_no","trainee_sort_code","console","log","catch","error","search","output","role","token","split","length","filter","obj","format","push","marginTop","t"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport CryptoJS from \"react-native-crypto-js\";\r\nimport { codes } from \"../secrets/secrets.js\";\r\nimport AccessDenied from './modules/AccessDenied';\r\nimport { authService } from './modules/authService';\r\nimport '../css/list-trainee-recruiter.css';\r\nimport DatePicker from 'react-datepicker';\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport { CSVLink } from \"react-csv\";\r\nimport moment from 'moment';\r\n\r\nexport default class ListTrainee extends Component {\r\n    \r\n    constructor(props) {\r\n        super(props);\r\n\t\t\t\r\n        this.state = {\r\n\t\t\ttrainees: [], \r\n\t\t\tsearchString: '',\r\n            currentUser: authService.currentUserValue,\r\n            selectedDate: '',\r\n            csv: ''\r\n\t\t\t};\r\n        \r\n       //Added onChangeSearch - Ernie\r\n        this.onChangeSearch = this.onChangeSearch.bind(this);\r\n    }\r\n    \r\n    componentDidMount() {\r\n        axios.get('http://'+process.env.REACT_APP_AWS_IP+':4000/trainee/')\r\n            .then(response => {\r\n                var encrypted = response.data;\r\n                encrypted.map(function(currentTrainee, i){\r\n                    var bytes  = CryptoJS.AES.decrypt(currentTrainee.trainee_email, codes.staff, {iv: codes.iv});\r\n                    currentTrainee.trainee_email = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_fname, codes.trainee);\r\n                    currentTrainee.trainee_fname = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_lname, codes.trainee);\r\n                    currentTrainee.trainee_lname = bytes.toString(CryptoJS.enc.Utf8);\r\n\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_start_date, codes.trainee);\r\n                    currentTrainee.trainee_start_date = bytes.toString(CryptoJS.enc.Utf8);\r\n                    bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_end_date, codes.trainee);\r\n                    currentTrainee.trainee_end_date = bytes.toString((CryptoJS.enc.Utf8));\r\n                    \r\n                    if(currentTrainee.trainee_bank_name != undefined && currentTrainee.trainee_account_no != undefined && currentTrainee.trainee_sort_code != undefined){\r\n                        console.log(currentTrainee.trainee_fname);\r\n                        bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_bank_name, codes.trainee);\r\n                        currentTrainee.trainee_bank_name = bytes.toString(CryptoJS.enc.Utf8);\r\n                        bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_account_no, codes.trainee);\r\n                        currentTrainee.trainee_account_no = bytes.toString(CryptoJS.enc.Utf8);\r\n                        bytes = CryptoJS.AES.decrypt(currentTrainee.trainee_sort_code, codes.trainee);\r\n                        currentTrainee.trainee_sort_code = bytes.toString(CryptoJS.enc.Utf8);\r\n                    }\r\n                });\r\n                this.setState({trainees: encrypted});\r\n            })\r\n            .catch(function (error){\r\n                console.log(error);\r\n            })\r\n    }\r\n\r\n    // Added onChangeSearch(e) function. Needed for the search filter\r\n    onChangeSearch= (e) =>{\r\n            this.setState({\r\n                searchString: e,\r\n                selectedDate: e\r\n            });\r\n    }\r\n\t\r\n    render() {\r\n        //Declared variables in order to read input from search function\r\n        let trainees = this.state.trainees;\r\n        let search = this.state.searchString;\r\n        let output = this.state.csv;\r\n        let role = this.state.currentUser.token.role\r\n        if(role === 'finance'){\r\n            output = [[\"First Name\", \"Last Name\", \"Email\", \"Bank Name\", \"Account Number\", \"Sort Number\",\"Start-Date\", \"End-Date\"]];\r\n        }else{\r\n            output = [[\"First Name\", \"Last Name\", \"Email\", \"Start-Date\", \"End-Date\"]];\r\n        }\r\n        \r\n        console.log((search.toString()).split(\" \", 4).toString());\r\n        \r\n        if(search.length > 0){\r\n            trainees = trainees.filter(function(i){\r\n                if(search == null){\r\n                    return i;\r\n                }\r\n                else if(i.trainee_start_date.split(\" \", 4).toString() === (search.toString()).split(\" \", 4).toString()){\r\n                    if(role === 'finance'){\r\n                        var obj =  [i.trainee_fname, i.trainee_lname, i.trainee_email, i.trainee_bank_name, i.trainee_account_no, i.trainee_sort_code, moment(i.trainee_start_date).format('MMMM Do YYYY'), moment(i.trainee_end_date).format('MMMM Do YYYY')];\r\n                        output.push(obj);\r\n                        console.log(output);\r\n                        return i;\r\n                    } else if(role === 'admin'){\r\n                        var obj =  [i.trainee_fname, i.trainee_lname, i.trainee_email, moment(i.trainee_start_date).format('MMMM Do YYYY'), moment(i.trainee_end_date).format('MMMM Do YYYY')];\r\n                        output.push(obj);\r\n                        console.log(output);\r\n                        return i;\r\n                    }\r\n                }\r\n            })\r\n        }\r\n        if(this.state.currentUser.token.role === 'finance' || this.state.currentUser.token.role === 'admin'){\r\n        return (\r\n            <div className=\"QAtable\">\r\n                <div className=\"QASearchBar\">\r\n                    <DatePicker\r\n                        selected={this.state.selectedDate}\r\n                        onChange={this.onChangeSearch}\r\n                        dateFormat=\"dd/MM/yyyy\"\r\n                        placeholderText=\"Specify Start Date to filter\"\r\n                        strictParsing\r\n                    />\r\n                    <div id=\"addUser\">\r\n                        <button className=\"qabtn\"><CSVLink className=\"link\" data={output} filename='monthly-intake.csv'>Download CSV </CSVLink></button>\r\n                    </div>\r\n                </div>\r\n\r\n                <table className=\"table table-striped\" style={{ marginTop: 20 }} >\r\n                    <thead>\r\n                        <tr>\r\n                            <th>First Name</th>\r\n                            <th>Last Name</th>\r\n                            <th>Email</th>\r\n                            <th>Start Date</th>\r\n                        </tr>\r\n                    </thead>               \r\n                    <tbody>\r\n                        {trainees.map(t => {\r\n                            return (\r\n                                <tr>\r\n                                    <td> {t.trainee_fname}</td>\r\n                                    <td> {t.trainee_lname}</td>\r\n                                    <td> {t.trainee_email}</td>\r\n                                    <td> {moment(t.trainee_start_date).format('MMMM Do YYYY')}</td>\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n\r\n                </table>\r\n            </div>\r\n        );\r\n        }\r\n        else{\r\n\t\t\treturn (\r\n\t\t\t<AccessDenied/>\r\n\t\t\t)\r\n        }\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}